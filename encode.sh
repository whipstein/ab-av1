# ffmpeg -y -i "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.mkv" -map 0 -c:v copy -c:v:0 libsvtav1 -svtav1-params "scd=0" -crf 32 -pix_fmt yuv420p10le -preset 8 -c:s copy -c:a copy -cues_to_front y "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.av1.mkv"

# ffmpeg -y -i "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.mkv" -map 0 -c:v copy -c:v:0 hevc_videotoolbox -preset main10 -b:v 15000k -pix_fmt p010le -c:s copy -c:a copy -cues_to_front y "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.av1.mkv"

# ffmpeg -y -i "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.mkv" -map 0 -c:v copy -c:v:0 hevc_videotoolbox -profile main10 -q:v 70 -pix_fmt p010le -c:s copy -c:a copy -cues_to_front y "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.av1.mkv"

# "ffmpeg" "-y" "-i" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.mkv" "-map" "0" "-c:v" "copy" "-c:v:0" "libsvtav1" "-svtav1-params" "scd=0" "-preset" "8" "-crf" "32" "-pix_fmt" "yuv420p10le" "-c:s" "copy" "-c:a" "copy" "-cues_to_front" "y" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.av1.mkv"

# "ffmpeg" "-y" "-i" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.mkv" "-map" "0" "-c:v" "copy" "-c:v:0" "libsvtav1" "-svtav1-params" "scd=0" "-crf" "32" "-pix_fmt" "yuv420p10le" "-preset" "8" "-c:s" "copy" "-c:a" "copy" "-cues_to_front" "y" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.av1.mkv"

# ffmpeg -y -i "/Users/schmatt/Documents/sandbox/ab-av1/.ab-av1-fQFPlK6Op40X/Strange Brew_t00.sample585+480f.mkv" -map 0 -c:v copy -c:v:0 hevc_videotoolbox -g 240 -profile main10 -pix_fmt yuv420p -c:s copy -c:a copy -cues_to_front y "/Users/schmatt/Documents/sandbox/ab-av1/.ab-av1-fQFPlK6Op40X/Strange Brew_t00.sample585+480f.hevc_vt.mkv"

infile="/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.mkv"
outfiles=("/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b2000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b3000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b4000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b5000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b6000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b7000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b8000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b9000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b10000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b11000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b12000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b13000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b14000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b15000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b16000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b17000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b18000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b19000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b20000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b21000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b22000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b23000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b24000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b25000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b26000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b27000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b28000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b29000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b30000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b31000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b32000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b33000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b34000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b35000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b36000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b37000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b38000.mkv" "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b39000.mkv")
bitrates=(2000 3000 4000 5000 6000 7000 8000 9000 10000 11000 12000 13000 14000 15000 16000 17000 18000 19000 20000 21000 22000 23000 24000 25000 26000 27000 28000 29000 30000 31000 32000 33000 34000 35000 36000 37000 38000 39000)

typeset -A assoc_array
assoc_array=("${(@)bitrates:^outfiles}")
# for key val in "${(@kv)assoc_array}"
# do
#   ./target/debug/ab-av1 encode -i $infile -o $val --bitrate $key
# done

for key val in "${(@kv)assoc_array}"
do
  echo "$key"
  ./target/debug/ab-av1 vmaf --reference $infile --distorted $val
done

# ./target/debug/ab-av1 vmaf --reference "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.mkv" --distorted "/Users/schmatt/Movies/Strange_Brew/.ab-av1-RZu7wZkQ9bDL/Strange Brew_t00.sample585+480f.hevc.b2000.mkv"
